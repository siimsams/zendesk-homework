I used weighted average to calculate the percentages. 

Traces are available here: http://localhost:16686

TODO: 
- Add tests
- Optimize queries and add indexes
- Add in memory caching
