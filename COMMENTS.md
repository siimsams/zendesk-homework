I used weighted average to calculate the percentages. 

TODO: 
- Add tests
- Optimize queries and add indexes
- Refactor GetAggregatedCategoryScores